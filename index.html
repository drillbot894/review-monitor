<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review Monitor - Track GBP Reviews Over Time</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #1a1a2e; color: #eee; min-height: 100vh; }
        
        .header { background: #16213e; padding: 20px; border-bottom: 1px solid #0f3460; }
        .header h1 { color: #e94560; font-size: 24px; display: flex; align-items: center; gap: 10px; }
        .header .subtitle { color: #888; font-size: 14px; margin-top: 5px; }
        
        .toolbar { background: #0f3460; padding: 15px 20px; display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }
        .toolbar input { padding: 10px 14px; border: none; border-radius: 6px; background: #1a1a2e; color: #fff; min-width: 200px; }
        .toolbar button { padding: 10px 18px; border: none; border-radius: 6px; cursor: pointer; font-weight: 500; transition: 0.2s; }
        .toolbar .btn-primary { background: #e94560; color: #fff; }
        .toolbar .btn-primary:hover { background: #ff6b6b; }
        .toolbar .btn-secondary { background: #1a1a2e; color: #aaa; border: 1px solid #e94560; }
        
        .stats-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 20px; }
        @media (max-width: 768px) { .stats-row { grid-template-columns: repeat(2, 1fr); } }
        
        .stat-card { background: #16213e; padding: 20px; border-radius: 12px; text-align: center; }
        .stat-card .value { font-size: 36px; font-weight: 700; color: #e94560; }
        .stat-card .label { color: #888; font-size: 13px; margin-top: 5px; }
        .stat-card .change { font-size: 12px; margin-top: 8px; }
        .stat-card .change.up { color: #4caf50; }
        .stat-card .change.down { color: #f44336; }
        
        .content { padding: 0 20px 20px; }
        
        .section-title { color: #fff; font-size: 18px; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; }
        
        .business-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 20px; margin-bottom: 30px; }
        
        .business-card { background: #16213e; border-radius: 12px; overflow: hidden; }
        .business-card .card-header { padding: 15px; background: #0f3460; display: flex; justify-content: space-between; align-items: flex-start; }
        .business-card .biz-name { font-size: 16px; font-weight: 600; color: #fff; }
        .business-card .biz-category { font-size: 12px; color: #888; margin-top: 4px; }
        .business-card .card-body { padding: 15px; }
        
        .rating-row { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; }
        .rating-big { font-size: 32px; font-weight: 700; color: #ffc107; }
        .rating-stars { color: #ffc107; font-size: 18px; letter-spacing: 2px; }
        .review-count { color: #888; font-size: 14px; }
        
        .metric-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #0f3460; }
        .metric-row:last-child { border-bottom: none; }
        .metric-label { color: #888; font-size: 13px; }
        .metric-value { color: #fff; font-weight: 500; }
        
        .velocity-bar { height: 8px; background: #0f3460; border-radius: 4px; overflow: hidden; margin-top: 10px; }
        .velocity-fill { height: 100%; background: linear-gradient(90deg, #4caf50, #8bc34a); border-radius: 4px; transition: 0.5s; }
        
        .trend-chart { height: 60px; display: flex; align-items: flex-end; gap: 4px; margin-top: 15px; }
        .trend-bar { flex: 1; background: #e94560; border-radius: 2px 2px 0 0; min-height: 4px; transition: 0.3s; }
        .trend-bar:hover { background: #ff6b6b; }
        
        .alert-badge { display: inline-flex; align-items: center; gap: 5px; padding: 4px 10px; border-radius: 20px; font-size: 11px; font-weight: 500; }
        .alert-badge.new { background: #4caf50; color: #fff; }
        .alert-badge.rating-up { background: #2196f3; color: #fff; }
        .alert-badge.rating-down { background: #f44336; color: #fff; }
        
        .history-table { background: #16213e; border-radius: 12px; overflow: hidden; margin-top: 20px; }
        .history-table table { width: 100%; border-collapse: collapse; }
        .history-table th { background: #0f3460; padding: 12px 16px; text-align: left; color: #888; font-weight: 500; font-size: 13px; }
        .history-table td { padding: 12px 16px; border-bottom: 1px solid #0f3460; }
        .history-table tr:hover { background: #1a1a2e; }
        
        .action-btns { display: flex; gap: 8px; }
        .action-btn { padding: 6px 12px; border: none; border-radius: 6px; cursor: pointer; font-size: 12px; transition: 0.2s; }
        .action-btn.check { background: #e94560; color: #fff; }
        .action-btn.view { background: #0f3460; color: #fff; }
        .action-btn.delete { background: transparent; color: #f44336; border: 1px solid #f44336; }
        
        .empty-state { text-align: center; padding: 60px 20px; color: #888; }
        .empty-state h3 { color: #e94560; margin-bottom: 10px; }
        
        .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); align-items: center; justify-content: center; z-index: 100; }
        .modal.show { display: flex; }
        .modal-content { background: #16213e; padding: 30px; border-radius: 12px; max-width: 500px; width: 90%; }
        .modal h3 { color: #fff; margin-bottom: 20px; }
        .modal input { width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #0f3460; border-radius: 8px; background: #1a1a2e; color: #fff; }
        .modal-buttons { display: flex; gap: 10px; justify-content: flex-end; }
        .modal-buttons button { padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; }
        .modal-buttons .cancel { background: #0f3460; color: #aaa; }
        .modal-buttons .save { background: #e94560; color: #fff; }
    </style>
</head>
<body>
    <div class="header">
        <h1>‚≠ê Review Monitor</h1>
        <div class="subtitle">Track GBP review counts and ratings over time</div>
    </div>
    
    <div class="toolbar">
        <button class="btn-primary" onclick="showAddModal()">‚ûï Add Business</button>
        <button class="btn-secondary" onclick="simulateNewReviews()">üé≤ Simulate New Reviews</button>
        <button class="btn-secondary" onclick="exportData()">üì§ Export</button>
    </div>
    
    <div class="stats-row">
        <div class="stat-card">
            <div class="value" id="totalBusinesses">0</div>
            <div class="label">Tracked Businesses</div>
        </div>
        <div class="stat-card">
            <div class="value" id="totalReviews">0</div>
            <div class="label">Total Reviews</div>
        </div>
        <div class="stat-card">
            <div class="value" id="avgRating">0</div>
            <div class="label">Average Rating</div>
        </div>
        <div class="stat-card">
            <div class="value" id="newThisWeek">0</div>
            <div class="label">New This Week</div>
            <div class="change up" id="velocity">‚Üë 0/day avg</div>
        </div>
    </div>
    
    <div class="content">
        <div class="section-title">
            <span>üìç Tracked Businesses</span>
            <span style="font-size: 14px; color: #888;">Click "Simulate" to see demo data</span>
        </div>
        
        <div class="business-grid" id="businessGrid">
            <div class="empty-state">
                <h3>No Businesses Yet</h3>
                <p>Add your first business to start tracking reviews</p>
            </div>
        </div>
        
        <div class="section-title">üìà Recent Activity</div>
        <div class="history-table">
            <table>
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Business</th>
                        <th>Change</th>
                        <th>Rating</th>
                        <th>Total Reviews</th>
                    </tr>
                </thead>
                <tbody id="historyTable">
                    <tr>
                        <td colspan="5" style="text-align: center; color: #888;">No activity yet</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- Add Business Modal -->
    <div class="modal" id="addModal">
        <div class="modal-content">
            <h3>Add Business to Track</h3>
            <input type="text" id="newBizName" placeholder="Business Name">
            <input type="text" id="newBizCategory" placeholder="Category (e.g., Plumber)">
            <input type="number" id="newBizRating" placeholder="Current Rating (e.g., 4.8)" step="0.1" max="5">
            <input type="number" id="newBizReviews" placeholder="Current Review Count">
            <div class="modal-buttons">
                <button class="cancel" onclick="closeModal()">Cancel</button>
                <button class="save" onclick="addBusiness()">Add Business</button>
            </div>
        </div>
    </div>

    <script>
        // Demo data
        let businesses = [];
        let history = [];
        
        // Initialize with some demo businesses
        function loadDemoData() {
            businesses = [
                { id: 1, name: 'Apex Plumbing', category: 'Plumber', rating: 4.8, reviews: 127, lastCheck: Date.now() - 86400000, trend: [12, 15, 11, 18, 14, 16, 12] },
                { id: 2, name: 'Elite Electric', category: 'Electrician', rating: 4.9, reviews: 89, lastCheck: Date.now() - 86400000, trend: [8, 10, 12, 9, 11, 14, 10] },
                { id: 3, name: 'Pro HVAC Services', category: 'HVAC', rating: 4.6, reviews: 234, lastCheck: Date.now() - 86400000, trend: [22, 25, 20, 28, 24, 30, 26] },
                { id: 4, name: 'Rapid Rooter', category: 'Plumber', rating: 4.7, reviews: 56, lastCheck: Date.now() - 172800000, trend: [5, 7, 6, 8, 4, 9, 7] }
            ];
            
            // Generate history
            const now = Date.now();
            history = [
                { date: new Date(now - 86400000).toLocaleDateString(), biz: 'Apex Plumbing', change: '+3', rating: 4.8, total: 127 },
                { date: new Date(now - 86400000).toLocaleDateString(), biz: 'Elite Electric', change: '+2', rating: 4.9, total: 89 },
                { date: new Date(now - 86400000).toLocaleDateString(), biz: 'Pro HVAC Services', change: '+5', rating: 4.6, total: 234 },
                { date: new Date(now - 172800000).toLocaleDateString(), biz: 'Rapid Rooter', change: '+2', rating: 4.7, total: 56 },
                { date: new Date(now - 259200000).toLocaleDateString(), biz: 'Apex Plumbing', change: '+1', rating: 4.8, total: 124 }
            ];
            
            renderDashboard();
        }
        
        function renderDashboard() {
            // Update stats
            document.getElementById('totalBusinesses').textContent = businesses.length;
            document.getElementById('totalReviews').textContent = businesses.reduce((sum, b) => sum + b.reviews, 0).toLocaleString();
            document.getElementById('avgRating').textContent = (businesses.reduce((sum, b) => sum + b.rating, 0) / businesses.length).toFixed(1);
            
            const weeklyReviews = businesses.reduce((sum, b) => sum + b.trend[b.trend.length - 1], 0);
            document.getElementById('newThisWeek').textContent = weeklyReviews;
            document.getElementById('velocity').textContent = `‚Üë ${Math.round(weeklyReviews / 7)}/day avg`;
            
            // Render business cards
            const grid = document.getElementById('businessGrid');
            if (businesses.length === 0) {
                grid.innerHTML = `<div class="empty-state"><h3>No Businesses Yet</h3><p>Add your first business to start tracking reviews</p></div>`;
            } else {
                grid.innerHTML = businesses.map(b => {
                    const maxTrend = Math.max(...b.trend);
                    const weeklyTotal = b.trend.reduce((a, c) => a + c, 0);
                    
                    return `
                        <div class="business-card">
                            <div class="card-header">
                                <div>
                                    <div class="biz-name">${b.name}</div>
                                    <div class="biz-category">${b.category}</div>
                                </div>
                                <div class="action-btns">
                                    <button class="action-btn check" onclick="checkReviews(${b.id})">Check</button>
                                    <button class="action-btn delete" onclick="removeBusiness(${b.id})">√ó</button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="rating-row">
                                    <div class="rating-big">${b.rating}</div>
                                    <div>
                                        <div class="rating-stars">‚òÖ${'‚òÖ'.repeat(Math.floor(b.rating))}</div>
                                        <div class="review-count">${b.reviews.toLocaleString()} reviews</div>
                                    </div>
                                </div>
                                
                                <div class="metric-row">
                                    <span class="metric-label">This Week</span>
                                    <span class="metric-value" style="color: #4caf50;">+${weeklyTotal} reviews</span>
                                </div>
                                <div class="metric-row">
                                    <span class="metric-label">Last Check</span>
                                    <span class="metric-value">${new Date(b.lastCheck).toLocaleDateString()}</span>
                                </div>
                                
                                <div class="velocity-bar">
                                    <div class="velocity-fill" style="width: ${(weeklyTotal / 30) * 100}%"></div>
                                </div>
                                
                                <div class="trend-chart">
                                    ${b.trend.map((v, i) => `<div class="trend-bar" style="height: ${(v / maxTrend) * 100}%" title="Day ${i+1}: ${v} reviews"></div>`).join('')}
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            }
            
            // Render history
            const historyTable = document.getElementById('historyTable');
            if (history.length === 0) {
                historyTable.innerHTML = `<tr><td colspan="5" style="text-align: center; color: #888;">No activity yet</td></tr>`;
            } else {
                historyTable.innerHTML = history.map(h => `
                    <tr>
                        <td>${h.date}</td>
                        <td>${h.biz}</td>
                        <td style="color: #4caf50; font-weight: 600;">${h.change}</td>
                        <td>‚òÖ ${h.rating}</td>
                        <td>${h.total.toLocaleString()}</td>
                    </tr>
                `).join('');
            }
        }
        
        function showAddModal() {
            document.getElementById('addModal').classList.add('show');
        }
        
        function closeModal() {
            document.getElementById('addModal').classList.remove('show');
        }
        
        function addBusiness() {
            const name = document.getElementById('newBizName').value;
            const category = document.getElementById('newBizCategory').value;
            const rating = parseFloat(document.getElementById('newBizRating').value) || 4.5;
            const reviews = parseInt(document.getElementById('newBizReviews').value) || 0;
            
            if (!name) return alert('Please enter a business name');
            
            const newBiz = {
                id: Date.now(),
                name,
                category: category || 'Local Business',
                rating,
                reviews,
                lastCheck: Date.now(),
                trend: [0, 0, 0, 0, 0, 0, 0]
            };
            
            businesses.push(newBiz);
            closeModal();
            renderDashboard();
            
            // Clear inputs
            document.getElementById('newBizName').value = '';
            document.getElementById('newBizCategory').value = '';
            document.getElementById('newBizRating').value = '';
            document.getElementById('newBizReviews').value = '';
        }
        
        function removeBusiness(id) {
            businesses = businesses.filter(b => b.id !== id);
            renderDashboard();
        }
        
        function checkReviews(id) {
            const biz = businesses.find(b => b.id === id);
            if (!biz) return;
            
            // Simulate finding new reviews
            const newReviews = Math.floor(Math.random() * 5);
            if (newReviews > 0) {
                const oldReviews = biz.reviews;
                biz.reviews += newReviews;
                biz.trend.shift();
                biz.trend.push(newReviews);
                biz.lastCheck = Date.now();
                
                // Occasionally change rating
                if (Math.random() > 0.7) {
                    biz.rating = Math.min(5, Math.max(1, biz.rating + (Math.random() > 0.5 ? 0.1 : -0.1)));
                }
                
                // Add to history
                history.unshift({
                    date: new Date().toLocaleDateString(),
                    biz: biz.name,
                    change: `+${newReviews}`,
                    rating: biz.rating.toFixed(1),
                    total: biz.reviews
                });
            }
            
            renderDashboard();
        }
        
        function simulateNewReviews() {
            if (businesses.length === 0) {
                loadDemoData();
                return;
            }
            
            businesses.forEach(biz => {
                const newReviews = Math.floor(Math.random() * 4) + 1;
                const oldReviews = biz.reviews;
                biz.reviews += newReviews;
                biz.trend.shift();
                biz.trend.push(newReviews);
                biz.lastCheck = Date.now();
                
                history.unshift({
                    date: new Date().toLocaleDateString(),
                    biz: biz.name,
                    change: `+${newReviews}`,
                    rating: biz.rating.toFixed(1),
                    total: biz.reviews
                });
            });
            
            // Keep history manageable
            if (history.length > 20) history = history.slice(0, 20);
            
            renderDashboard();
        }
        
        function exportData() {
            const data = {
                businesses,
                history,
                exported: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'review-monitor-export.json';
            a.click();
        }
        
        // Auto-simulate on load if no data
        if (businesses.length === 0) {
            setTimeout(simulateNewReviews, 1000);
        }
    </script>
</body>
</html>
